<h2>User</h2>

<p><code>/_plugins/user.php</code></p>

<p>
	The user plugin handles user authentication and preferences. This plugin requires a database and depends on the
	<a href="./mysql">MySQL</a> (or any other database) and <a href="./session">Session</a> plugins.
</p>

<h5>Example</h5>

<pre>
<?php
if ( $app->session->get('user id') != User::GUEST_ID )
{
	// User is logged in
}

if ( $app->session->get('user is owner') )
{
	// User is the website owner
}
?>
</pre>

<h3>Preferences</h3>

<p>
	Plugins can add new preferences to user accounts. Users can change their preferences on the account page (<code>/account/</code>).
</p>

<p>
	The <code>$app-&gt;user-&gt;save_pref()</code> function requires three or four parameters.
</p>

<ul>
	<li>
		<code>pref</code><br/>
		The name of the preference.
	</li>
	<li>
		<code>type</code><br/>
		The type of preference, one of <em>select</em> (multiple choice), <em>text</em> (manual input) and <em>checkbox</em> (yes/no).
	</li>
	<li>
		<code>match</code><br/>
		A regular expression to validate the user input.
	</li>
	<li>
		<code>options</code><br/>
		An array with options (presented to the user), only used when the type is set to <code>select</code>.
	</li>
</ul>

<h4>Example</h4>

<pre>
<?php
$app->user->save_pref(array(
	'pref'    => 'Example',
	'type'    => 'select',
	'match'   => '/.*/',
	'options' => array(1 => 'Option 1', 2 => 'Option 2')
	));
?>
</pre>

<h2>Class</h2>

<p>
	<code>$app-&gt;user</code>
</p>

<h4>Public functions</h4>

<ul>
	<li>
		<code>$app-&gt;user-&gt;login ( <em>string</em> $username, <em>string</em> $password )</code><br/>
		Logs the user in with a username and password and updates the session.
	</li>
	<li>
		<code>$app-&gt;user-&gt;logout ( )</code><br/>
		Logs the user out and resets the session.
	</li>
	<li>
		<code>$app-&gt;user-&gt;validate_password ( <em>string</em> $username, <em>string</em> $password )</code><br/>
		Checks if a username/password combination is correct.
	</li>
	<li>
		<code>$app-&gt;user-&gt;make_pass_hash ( <em>string</em> $username, <em>string</em> $password )</code><br/>
		Generates a password hash.
	</li>
	<li>
		<code>$app-&gt;user-&gt;save_pref ( <em>array</em> $params )</code><br/>
		Saves a preference.
	</li>
	<li>
		<code>$app-&gt;user-&gt;delete_pref ( <em>string</em> $pref )</code><br/>
		Deletes a preference.
	</li>
	<li>
		<code>$app-&gt;user-&gt;save_pref_value ( <em>string</em> $params )</code><br/>
		Saves a preference value.
	</li>
	<li>
		<code>$app-&gt;user-&gt;get_pref_values ( <em>int</em> $userId )</code><br/>
		Gets a user's preferences.
	</li>
</ul>

<h4>Constants</h4>

<ul>
	<li>
		<code>User::GUEST_ID</code><br/>
		Reserved user ID for all guest users (users who are not logged in). This can be used to test if a user is logged in or not
		(e.g. <code>if ( $app->session->get('user id') != User::GUEST_ID )</code>).
	</li>
</ul>
